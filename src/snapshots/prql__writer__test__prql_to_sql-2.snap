---
source: src/writer.rs
assertion_line: 674
expression: sql
---
SELECT
  TOP (20) salary + payroll_tax AS gross_salary,
  salary + payroll_tax + benefits_cost AS gross_cost,
  SUM(salary + payroll_tax + benefits_cost) AS sum_gross_cost,
  COUNT(*) AS count,
  AVG(salary),
  SUM(salary),
  AVG(salary + payroll_tax),
  SUM(salary + payroll_tax),
  AVG(salary + payroll_tax + benefits_cost)
FROM
  employees
WHERE
  country = 'USA'
  and salary + payroll_tax + benefits_cost > 0
GROUP BY
  title,
  country
ORDER BY
  SUM(salary + payroll_tax + benefits_cost)

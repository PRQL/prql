---
source: reference/tests/snapshot.rs
assertion_line: 113
expression: sql
input_file: reference/tests/examples/examples/variables-1.prql
---
Failed to compile `from employees
group [emp_no] (
  aggregate [
    emp_salary = average salary     # average salary resolves to "AVG(salary)" (from stdlib)
  ]
)
join titles [emp_no]
group [title] (
  aggregate [
    avg_salary = average emp_salary
  ]
)
select salary_k = avg_salary / 1000 # avg_salary should resolve to "AVG(emp_salary)"
take 10                             # induces new SELECT
derive salary = salary_k * 1000     # salary_k should not resolve to "avg_salary / 1000"
`;   --> 31:9
   |
31 | func lag<column> offset column ->  s"LAG({column}, {offset})"␊
   |         ^---
   |
   = expected func_def_param

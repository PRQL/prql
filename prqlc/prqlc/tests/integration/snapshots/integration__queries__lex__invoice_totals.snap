---
source: prqlc/prqlc/tests/integration/queries.rs
expression: tokens
input_file: prqlc/prqlc/tests/integration/queries/invoice_totals.prql
---
TokenVec (
  0..56: Comment(" clickhouse:skip (clickhouse doesn't have lag function)"),
  56..57: NewLine,
  57..58: NewLine,
  58..130: DocComment(" Calculate a number of metrics about the sales of tracks in each city."),
  130..131: NewLine,
  131..135: Ident("from"),
  136..138: Ident("db"),
  138..139: Control('.'),
  139..147: Ident("invoices"),
  147..148: NewLine,
  148..154: Ident("select"),
  155..156: Control('{'),
  156..157: Ident("i"),
  158..159: Control('='),
  160..164: Ident("this"),
  164..165: Control('}'),
  165..166: NewLine,
  166..170: Ident("join"),
  171..172: Control('('),
  172..174: Ident("db"),
  174..175: Control('.'),
  175..188: Ident("invoice_items"),
  189..190: Control('|'),
  191..197: Ident("select"),
  198..199: Control('{'),
  199..201: Ident("ii"),
  202..203: Control('='),
  204..208: Ident("this"),
  208..209: Control('}'),
  209..210: Control(')'),
  211..212: Control('('),
  212..214: Eq,
  214..224: Ident("invoice_id"),
  224..225: Control(')'),
  225..226: NewLine,
  226..232: Ident("derive"),
  233..234: Control('{'),
  234..235: NewLine,
  239..243: Ident("city"),
  244..245: Control('='),
  246..247: Ident("i"),
  247..248: Control('.'),
  248..260: Ident("billing_city"),
  260..261: Control(','),
  261..262: NewLine,
  266..272: Ident("street"),
  273..274: Control('='),
  275..276: Ident("i"),
  276..277: Control('.'),
  277..292: Ident("billing_address"),
  292..293: Control(','),
  293..294: NewLine,
  294..295: Control('}'),
  295..296: NewLine,
  296..301: Ident("group"),
  302..303: Control('{'),
  303..307: Ident("city"),
  307..308: Control(','),
  309..315: Ident("street"),
  315..316: Control('}'),
  317..318: Control('('),
  318..319: NewLine,
  323..329: Ident("derive"),
  330..335: Ident("total"),
  336..337: Control('='),
  338..340: Ident("ii"),
  340..341: Control('.'),
  341..351: Ident("unit_price"),
  352..353: Control('*'),
  354..356: Ident("ii"),
  356..357: Control('.'),
  357..365: Ident("quantity"),
  365..366: NewLine,
  370..379: Ident("aggregate"),
  380..381: Control('{'),
  381..382: NewLine,
  390..400: Ident("num_orders"),
  401..402: Control('='),
  403..417: Ident("count_distinct"),
  418..419: Ident("i"),
  419..420: Control('.'),
  420..430: Ident("invoice_id"),
  430..431: Control(','),
  431..432: NewLine,
  440..450: Ident("num_tracks"),
  451..452: Control('='),
  453..456: Ident("sum"),
  457..459: Ident("ii"),
  459..460: Control('.'),
  460..468: Ident("quantity"),
  468..469: Control(','),
  469..470: NewLine,
  478..489: Ident("total_price"),
  490..491: Control('='),
  492..495: Ident("sum"),
  496..501: Ident("total"),
  501..502: Control(','),
  502..503: NewLine,
  507..508: Control('}'),
  508..509: NewLine,
  509..510: Control(')'),
  510..511: NewLine,
  511..516: Ident("group"),
  517..518: Control('{'),
  518..522: Ident("city"),
  522..523: Control('}'),
  524..525: Control('('),
  525..526: NewLine,
  530..534: Ident("sort"),
  535..541: Ident("street"),
  541..542: NewLine,
  546..552: Ident("window"),
  553..562: Ident("expanding"),
  562..563: Control(':'),
  563..567: Literal(Boolean(true)),
  568..569: Control('('),
  569..570: NewLine,
  578..584: Ident("derive"),
  585..586: Control('{'),
  586..610: Ident("running_total_num_tracks"),
  611..612: Control('='),
  613..616: Ident("sum"),
  617..627: Ident("num_tracks"),
  627..628: Control('}'),
  628..629: NewLine,
  633..634: Control(')'),
  634..635: NewLine,
  635..636: Control(')'),
  636..637: NewLine,
  637..641: Ident("sort"),
  642..643: Control('{'),
  643..647: Ident("city"),
  647..648: Control(','),
  649..655: Ident("street"),
  655..656: Control('}'),
  656..657: NewLine,
  657..663: Ident("derive"),
  664..665: Control('{'),
  665..685: Ident("num_tracks_last_week"),
  686..687: Control('='),
  688..691: Ident("lag"),
  692..693: Literal(Integer(7)),
  694..704: Ident("num_tracks"),
  704..705: Control('}'),
  705..706: NewLine,
  706..712: Ident("select"),
  713..714: Control('{'),
  714..715: NewLine,
  719..723: Ident("city"),
  723..724: Control(','),
  724..725: NewLine,
  729..735: Ident("street"),
  735..736: Control(','),
  736..737: NewLine,
  741..751: Ident("num_orders"),
  751..752: Control(','),
  752..753: NewLine,
  757..767: Ident("num_tracks"),
  767..768: Control(','),
  768..769: NewLine,
  773..797: Ident("running_total_num_tracks"),
  797..798: Control(','),
  798..799: NewLine,
  803..823: Ident("num_tracks_last_week"),
  823..824: NewLine,
  824..825: Control('}'),
  825..826: NewLine,
  826..830: Ident("take"),
  831..833: Literal(Integer(20)),
  833..834: NewLine,
)

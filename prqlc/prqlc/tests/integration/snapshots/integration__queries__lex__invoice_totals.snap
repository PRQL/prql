---
source: prqlc/prqlc/tests/integration/queries.rs
expression: tokens
input_file: prqlc/prqlc/tests/integration/queries/invoice_totals.prql
---
TokenVec (
  0..56: Comment(" clickhouse:skip (clickhouse doesn't have lag function)"),
  56..57: NewLine,
  57..58: NewLine,
  58..130: DocComment(" Calculate a number of metrics about the sales of tracks in each city."),
  130..131: NewLine,
  131..135: Ident("from"),
  135..136: Control('.'),
  136..144: Ident("invoices"),
  144..145: NewLine,
  145..151: Ident("select"),
  152..153: Control('{'),
  153..154: Ident("i"),
  155..156: Control('='),
  157..161: Ident("this"),
  161..162: Control('}'),
  162..163: NewLine,
  163..167: Ident("join"),
  168..169: Control('('),
  169..173: Ident("from"),
  173..174: Control('.'),
  174..187: Ident("invoice_items"),
  188..189: Control('|'),
  190..196: Ident("select"),
  197..198: Control('{'),
  198..200: Ident("ii"),
  201..202: Control('='),
  203..207: Ident("this"),
  207..208: Control('}'),
  208..209: Control(')'),
  210..211: Control('('),
  211..213: Eq,
  213..223: Ident("invoice_id"),
  223..224: Control(')'),
  224..225: NewLine,
  225..231: Ident("derive"),
  232..233: Control('{'),
  233..234: NewLine,
  238..242: Ident("city"),
  243..244: Control('='),
  245..246: Ident("i"),
  246..247: Control('.'),
  247..259: Ident("billing_city"),
  259..260: Control(','),
  260..261: NewLine,
  265..271: Ident("street"),
  272..273: Control('='),
  274..275: Ident("i"),
  275..276: Control('.'),
  276..291: Ident("billing_address"),
  291..292: Control(','),
  292..293: NewLine,
  293..294: Control('}'),
  294..295: NewLine,
  295..300: Ident("group"),
  301..302: Control('{'),
  302..306: Ident("city"),
  306..307: Control(','),
  308..314: Ident("street"),
  314..315: Control('}'),
  316..317: Control('('),
  317..318: NewLine,
  322..328: Ident("derive"),
  329..334: Ident("total"),
  335..336: Control('='),
  337..339: Ident("ii"),
  339..340: Control('.'),
  340..350: Ident("unit_price"),
  351..352: Control('*'),
  353..355: Ident("ii"),
  355..356: Control('.'),
  356..364: Ident("quantity"),
  364..365: NewLine,
  369..378: Ident("aggregate"),
  379..380: Control('{'),
  380..381: NewLine,
  389..399: Ident("num_orders"),
  400..401: Control('='),
  402..416: Ident("count_distinct"),
  417..418: Ident("i"),
  418..419: Control('.'),
  419..429: Ident("invoice_id"),
  429..430: Control(','),
  430..431: NewLine,
  439..449: Ident("num_tracks"),
  450..451: Control('='),
  452..455: Ident("sum"),
  456..458: Ident("ii"),
  458..459: Control('.'),
  459..467: Ident("quantity"),
  467..468: Control(','),
  468..469: NewLine,
  477..488: Ident("total_price"),
  489..490: Control('='),
  491..494: Ident("sum"),
  495..500: Ident("total"),
  500..501: Control(','),
  501..502: NewLine,
  506..507: Control('}'),
  507..508: NewLine,
  508..509: Control(')'),
  509..510: NewLine,
  510..515: Ident("group"),
  516..517: Control('{'),
  517..521: Ident("city"),
  521..522: Control('}'),
  523..524: Control('('),
  524..525: NewLine,
  529..533: Ident("sort"),
  534..540: Ident("street"),
  540..541: NewLine,
  545..551: Ident("window"),
  552..561: Ident("expanding"),
  561..562: Control(':'),
  562..566: Literal(Boolean(true)),
  567..568: Control('('),
  568..569: NewLine,
  577..583: Ident("derive"),
  584..585: Control('{'),
  585..609: Ident("running_total_num_tracks"),
  610..611: Control('='),
  612..615: Ident("sum"),
  616..626: Ident("num_tracks"),
  626..627: Control('}'),
  627..628: NewLine,
  632..633: Control(')'),
  633..634: NewLine,
  634..635: Control(')'),
  635..636: NewLine,
  636..640: Ident("sort"),
  641..642: Control('{'),
  642..646: Ident("city"),
  646..647: Control(','),
  648..654: Ident("street"),
  654..655: Control('}'),
  655..656: NewLine,
  656..662: Ident("derive"),
  663..664: Control('{'),
  664..684: Ident("num_tracks_last_week"),
  685..686: Control('='),
  687..690: Ident("lag"),
  691..692: Literal(Integer(7)),
  693..703: Ident("num_tracks"),
  703..704: Control('}'),
  704..705: NewLine,
  705..711: Ident("select"),
  712..713: Control('{'),
  713..714: NewLine,
  718..722: Ident("city"),
  722..723: Control(','),
  723..724: NewLine,
  728..734: Ident("street"),
  734..735: Control(','),
  735..736: NewLine,
  740..750: Ident("num_orders"),
  750..751: Control(','),
  751..752: NewLine,
  756..766: Ident("num_tracks"),
  766..767: Control(','),
  767..768: NewLine,
  772..796: Ident("running_total_num_tracks"),
  796..797: Control(','),
  797..798: NewLine,
  802..822: Ident("num_tracks_last_week"),
  822..823: NewLine,
  823..824: Control('}'),
  824..825: NewLine,
  825..829: Ident("take"),
  830..832: Literal(Integer(20)),
  832..833: NewLine,
)

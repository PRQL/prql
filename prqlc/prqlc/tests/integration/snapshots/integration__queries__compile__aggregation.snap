---
source: prqlc/prqlc/tests/integration/queries.rs
expression: "# sqlite:skip\n# mssql:skip\n# mysql:skip\n# clickhouse:skip\n# glaredb:skip (the string_agg function is not supported)\nfrom tracks\nfilter genre_id == 100\nderive empty_name = name == ''\naggregate {\n  s = (sum track_id | as REAL),\n  c = concat_array name,\n  a = all empty_name,\n  n = any empty_name,\n}\n"
input_file: prqlc/prqlc/tests/integration/queries/aggregation.prql
---
SELECT
  CAST(COALESCE(SUM(track_id), 0) AS REAL) AS s,
  COALESCE(STRING_AGG(name, ''), '') AS c,
  COALESCE(BOOL_AND(name = ''), TRUE) AS a,
  COALESCE(BOOL_OR(name = ''), FALSE) AS n
FROM
  tracks
WHERE
  genre_id = 100

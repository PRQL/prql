---
source: prqlc/prqlc/tests/integration/queries.rs
expression: "from invoices\nderive code = case [customer_id < 10 => billing_postal_code, true => null]\ngroup {customer_id, billing_city, billing_country} (\n  sort {-this.code}\n  take 1\n)\nfilter (customer_id | in [4])\ngroup {billing_country} (aggregate {total = math.round 2 (sum total)})\n"
input_file: prqlc/prqlc/tests/integration/queries/distinct_on_sort_on_compute.prql
---
from invoices
derive code = case [customer_id < 10 => billing_postal_code, true => null]
group {customer_id, billing_city, billing_country} (
  sort {-this.code}
  take 1
)
filter (customer_id | in [4])
group {billing_country} (aggregate {total = math.round 2 (sum total)})

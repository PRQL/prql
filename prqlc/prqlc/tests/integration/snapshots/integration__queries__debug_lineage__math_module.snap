---
source: prqlc/prqlc/tests/integration/queries.rs
expression: "# mssql:test\n# sqlite:skip (see https://github.com/rusqlite/rusqlite/issues/1211)\nfrom invoices\ntake 5\nselect {\n    total_original = (total | math.round 2 | as REAL),\n    total_x = (math.pi - total | math.round 2 | math.abs | as REAL),\n    total_floor = (math.floor total | as REAL),\n    total_ceil = (math.ceil total | as REAL),\n    total_log10 = (math.log10 total | math.round 3 | as REAL),\n    total_log2 = (math.log 2 total | math.round 3 | as REAL),\n    total_sqrt = (math.sqrt total | math.round 3 | as REAL),\n    total_ln = (math.ln total | math.exp | math.round 2 | as REAL),\n    total_cos = (math.cos total | math.acos | math.round 2 | as REAL),\n    total_sin = (math.sin total | math.asin | math.round 2 | as REAL),\n    total_tan = (math.tan total | math.atan | math.round 2 | as REAL),\n    total_deg = (total | math.degrees | math.radians | math.round 2 | as REAL),\n    total_square = (total | math.pow 2 | math.round 2 | as REAL),\n    total_square_op = ((total ** 2) | math.round 2 | as REAL),\n}\n"
input_file: prqlc/prqlc/tests/integration/queries/math_module.prql
---
frames:
- - 1:96-102
  - columns:
    - !All
      input_id: 121
      except: []
    inputs:
    - id: 121
      name: invoices
      table:
      - default_db
      - invoices
- - 1:103-1007
  - columns:
    - !Single
      name:
      - total_original
      target_id: 126
      target_name: null
    - !Single
      name:
      - total_x
      target_id: 134
      target_name: null
    - !Single
      name:
      - total_floor
      target_id: 148
      target_name: null
    - !Single
      name:
      - total_ceil
      target_id: 154
      target_name: null
    - !Single
      name:
      - total_log10
      target_id: 160
      target_name: null
    - !Single
      name:
      - total_log2
      target_id: 170
      target_name: null
    - !Single
      name:
      - total_sqrt
      target_id: 181
      target_name: null
    - !Single
      name:
      - total_ln
      target_id: 191
      target_name: null
    - !Single
      name:
      - total_cos
      target_id: 203
      target_name: null
    - !Single
      name:
      - total_sin
      target_id: 215
      target_name: null
    - !Single
      name:
      - total_tan
      target_id: 227
      target_name: null
    - !Single
      name:
      - total_deg
      target_id: 239
      target_name: null
    - !Single
      name:
      - total_square
      target_id: 251
      target_name: null
    - !Single
      name:
      - total_square_op
      target_id: 263
      target_name: null
    inputs:
    - id: 121
      name: invoices
      table:
      - default_db
      - invoices
nodes:
- id: 121
  kind: Ident
  span: 1:82-95
  ident: !Ident
  - default_db
  - invoices
  parent: 124
- id: 124
  kind: 'TransformCall: Take'
  span: 1:96-102
  children:
  - 121
  - 125
  parent: 275
- id: 125
  kind: Literal
  parent: 124
- id: 126
  kind: RqOperator
  span: 1:157-164
  alias: total_original
  targets:
  - 129
  parent: 274
- id: 129
  kind: RqOperator
  span: 1:142-154
  targets:
  - 132
  - 133
- id: 132
  kind: Literal
  span: 1:153-154
- id: 133
  kind: Ident
  span: 1:134-139
  ident: !Ident
  - this
  - invoices
  - total
  targets:
  - 121
- id: 134
  kind: RqOperator
  span: 1:226-233
  alias: total_x
  targets:
  - 137
  parent: 274
- id: 137
  kind: RqOperator
  span: 1:215-223
  targets:
  - 139
- id: 139
  kind: RqOperator
  span: 1:200-212
  targets:
  - 142
  - 143
- id: 142
  kind: Literal
  span: 1:211-212
- id: 143
  kind: RqOperator
  span: 1:182-197
  targets:
  - 146
  - 147
- id: 146
  kind: RqOperator
  span: 1:186-189
- id: 147
  kind: Ident
  span: 1:192-197
  ident: !Ident
  - this
  - invoices
  - total
  targets:
  - 121
- id: 148
  kind: RqOperator
  span: 1:274-281
  alias: total_floor
  targets:
  - 151
  parent: 274
- id: 151
  kind: RqOperator
  span: 1:255-271
  targets:
  - 153
- id: 153
  kind: Ident
  span: 1:266-271
  ident: !Ident
  - this
  - invoices
  - total
  targets:
  - 121
- id: 154
  kind: RqOperator
  span: 1:320-327
  alias: total_ceil
  targets:
  - 157
  parent: 274
- id: 157
  kind: RqOperator
  span: 1:302-317
  targets:
  - 159
- id: 159
  kind: Ident
  span: 1:312-317
  ident: !Ident
  - this
  - invoices
  - total
  targets:
  - 121
- id: 160
  kind: RqOperator
  span: 1:383-390
  alias: total_log10
  targets:
  - 163
  parent: 274
- id: 163
  kind: RqOperator
  span: 1:368-380
  targets:
  - 166
  - 167
- id: 166
  kind: Literal
  span: 1:379-380
- id: 167
  kind: RqOperator
  span: 1:349-365
  targets:
  - 169
- id: 169
  kind: Ident
  span: 1:360-365
  ident: !Ident
  - this
  - invoices
  - total
  targets:
  - 121
- id: 170
  kind: RqOperator
  span: 1:445-452
  alias: total_log2
  targets:
  - 173
  parent: 274
- id: 173
  kind: RqOperator
  span: 1:430-442
  targets:
  - 176
  - 177
- id: 176
  kind: Literal
  span: 1:441-442
- id: 177
  kind: RqOperator
  span: 1:411-427
  targets:
  - 179
  - 180
- id: 179
  kind: Literal
  span: 1:420-421
- id: 180
  kind: Ident
  span: 1:422-427
  ident: !Ident
  - this
  - invoices
  - total
  targets:
  - 121
- id: 181
  kind: RqOperator
  span: 1:506-513
  alias: total_sqrt
  targets:
  - 184
  parent: 274
- id: 184
  kind: RqOperator
  span: 1:491-503
  targets:
  - 187
  - 188
- id: 187
  kind: Literal
  span: 1:502-503
- id: 188
  kind: RqOperator
  span: 1:473-488
  targets:
  - 190
- id: 190
  kind: Ident
  span: 1:483-488
  ident: !Ident
  - this
  - invoices
  - total
  targets:
  - 121
- id: 191
  kind: RqOperator
  span: 1:574-581
  alias: total_ln
  targets:
  - 194
  parent: 274
- id: 194
  kind: RqOperator
  span: 1:559-571
  targets:
  - 197
  - 198
- id: 197
  kind: Literal
  span: 1:570-571
- id: 198
  kind: RqOperator
  span: 1:548-556
  targets:
  - 200
- id: 200
  kind: RqOperator
  span: 1:532-545
  targets:
  - 202
- id: 202
  kind: Ident
  span: 1:540-545
  ident: !Ident
  - this
  - invoices
  - total
  targets:
  - 121
- id: 203
  kind: RqOperator
  span: 1:645-652
  alias: total_cos
  targets:
  - 206
  parent: 274
- id: 206
  kind: RqOperator
  span: 1:630-642
  targets:
  - 209
  - 210
- id: 209
  kind: Literal
  span: 1:641-642
- id: 210
  kind: RqOperator
  span: 1:618-627
  targets:
  - 212
- id: 212
  kind: RqOperator
  span: 1:601-615
  targets:
  - 214
- id: 214
  kind: Ident
  span: 1:610-615
  ident: !Ident
  - this
  - invoices
  - total
  targets:
  - 121
- id: 215
  kind: RqOperator
  span: 1:716-723
  alias: total_sin
  targets:
  - 218
  parent: 274
- id: 218
  kind: RqOperator
  span: 1:701-713
  targets:
  - 221
  - 222
- id: 221
  kind: Literal
  span: 1:712-713
- id: 222
  kind: RqOperator
  span: 1:689-698
  targets:
  - 224
- id: 224
  kind: RqOperator
  span: 1:672-686
  targets:
  - 226
- id: 226
  kind: Ident
  span: 1:681-686
  ident: !Ident
  - this
  - invoices
  - total
  targets:
  - 121
- id: 227
  kind: RqOperator
  span: 1:787-794
  alias: total_tan
  targets:
  - 230
  parent: 274
- id: 230
  kind: RqOperator
  span: 1:772-784
  targets:
  - 233
  - 234
- id: 233
  kind: Literal
  span: 1:783-784
- id: 234
  kind: RqOperator
  span: 1:760-769
  targets:
  - 236
- id: 236
  kind: RqOperator
  span: 1:743-757
  targets:
  - 238
- id: 238
  kind: Ident
  span: 1:752-757
  ident: !Ident
  - this
  - invoices
  - total
  targets:
  - 121
- id: 239
  kind: RqOperator
  span: 1:867-874
  alias: total_deg
  targets:
  - 242
  parent: 274
- id: 242
  kind: RqOperator
  span: 1:852-864
  targets:
  - 245
  - 246
- id: 245
  kind: Literal
  span: 1:863-864
- id: 246
  kind: RqOperator
  span: 1:837-849
  targets:
  - 248
- id: 248
  kind: RqOperator
  span: 1:822-834
  targets:
  - 250
- id: 250
  kind: Ident
  span: 1:814-819
  ident: !Ident
  - this
  - invoices
  - total
  targets:
  - 121
- id: 251
  kind: RqOperator
  span: 1:933-940
  alias: total_square
  targets:
  - 254
  parent: 274
- id: 254
  kind: RqOperator
  span: 1:918-930
  targets:
  - 257
  - 258
- id: 257
  kind: Literal
  span: 1:929-930
- id: 258
  kind: RqOperator
  span: 1:905-915
  targets:
  - 261
  - 262
- id: 261
  kind: Literal
  span: 1:914-915
- id: 262
  kind: Ident
  span: 1:897-902
  ident: !Ident
  - this
  - invoices
  - total
  targets:
  - 121
- id: 263
  kind: RqOperator
  span: 1:996-1003
  alias: total_square_op
  targets:
  - 266
  parent: 274
- id: 266
  kind: RqOperator
  span: 1:981-993
  targets:
  - 269
  - 270
- id: 269
  kind: Literal
  span: 1:992-993
- id: 270
  kind: RqOperator
  span: 1:966-978
  targets:
  - 272
  - 273
- id: 272
  kind: Literal
  span: 1:976-977
- id: 273
  kind: Ident
  span: 1:967-972
  ident: !Ident
  - this
  - invoices
  - total
  targets:
  - 121
- id: 274
  kind: Tuple
  span: 1:110-1007
  children:
  - 126
  - 134
  - 148
  - 154
  - 160
  - 170
  - 181
  - 191
  - 203
  - 215
  - 227
  - 239
  - 251
  - 263
  parent: 275
- id: 275
  kind: 'TransformCall: Select'
  span: 1:103-1007
  children:
  - 124
  - 274
ast:
  name: Project
  stmts:
  - VarDef:
      kind: Main
      name: main
      value:
        Pipeline:
          exprs:
          - FuncCall:
              name:
                Ident: from
                span: 1:82-86
              args:
              - Ident: invoices
                span: 1:87-95
            span: 1:82-95
          - FuncCall:
              name:
                Ident: take
                span: 1:96-100
              args:
              - Literal:
                  Integer: 5
                span: 1:101-102
            span: 1:96-102
          - FuncCall:
              name:
                Ident: select
                span: 1:103-109
              args:
              - Tuple:
                - Pipeline:
                    exprs:
                    - Ident: total
                      span: 1:134-139
                    - FuncCall:
                        name:
                          Indirection:
                            base:
                              Ident: math
                              span: 1:142-146
                            field: !Name round
                          span: 1:146-152
                        args:
                        - Literal:
                            Integer: 2
                          span: 1:153-154
                      span: 1:142-154
                    - FuncCall:
                        name:
                          Ident: as
                          span: 1:157-159
                        args:
                        - Ident: REAL
                          span: 1:160-164
                      span: 1:157-164
                  span: 1:133-165
                  alias: total_original
                - Pipeline:
                    exprs:
                    - Binary:
                        left:
                          Indirection:
                            base:
                              Ident: math
                              span: 1:182-186
                            field: !Name pi
                          span: 1:186-189
                        op: Sub
                        right:
                          Ident: total
                          span: 1:192-197
                      span: 1:182-197
                    - FuncCall:
                        name:
                          Indirection:
                            base:
                              Ident: math
                              span: 1:200-204
                            field: !Name round
                          span: 1:204-210
                        args:
                        - Literal:
                            Integer: 2
                          span: 1:211-212
                      span: 1:200-212
                    - Indirection:
                        base:
                          Ident: math
                          span: 1:215-219
                        field: !Name abs
                      span: 1:215-223
                    - FuncCall:
                        name:
                          Ident: as
                          span: 1:226-228
                        args:
                        - Ident: REAL
                          span: 1:229-233
                      span: 1:226-233
                  span: 1:181-234
                  alias: total_x
                - Pipeline:
                    exprs:
                    - FuncCall:
                        name:
                          Indirection:
                            base:
                              Ident: math
                              span: 1:255-259
                            field: !Name floor
                          span: 1:259-265
                        args:
                        - Ident: total
                          span: 1:266-271
                      span: 1:255-271
                    - FuncCall:
                        name:
                          Ident: as
                          span: 1:274-276
                        args:
                        - Ident: REAL
                          span: 1:277-281
                      span: 1:274-281
                  span: 1:254-282
                  alias: total_floor
                - Pipeline:
                    exprs:
                    - FuncCall:
                        name:
                          Indirection:
                            base:
                              Ident: math
                              span: 1:302-306
                            field: !Name ceil
                          span: 1:306-311
                        args:
                        - Ident: total
                          span: 1:312-317
                      span: 1:302-317
                    - FuncCall:
                        name:
                          Ident: as
                          span: 1:320-322
                        args:
                        - Ident: REAL
                          span: 1:323-327
                      span: 1:320-327
                  span: 1:301-328
                  alias: total_ceil
                - Pipeline:
                    exprs:
                    - FuncCall:
                        name:
                          Indirection:
                            base:
                              Ident: math
                              span: 1:349-353
                            field: !Name log10
                          span: 1:353-359
                        args:
                        - Ident: total
                          span: 1:360-365
                      span: 1:349-365
                    - FuncCall:
                        name:
                          Indirection:
                            base:
                              Ident: math
                              span: 1:368-372
                            field: !Name round
                          span: 1:372-378
                        args:
                        - Literal:
                            Integer: 3
                          span: 1:379-380
                      span: 1:368-380
                    - FuncCall:
                        name:
                          Ident: as
                          span: 1:383-385
                        args:
                        - Ident: REAL
                          span: 1:386-390
                      span: 1:383-390
                  span: 1:348-391
                  alias: total_log10
                - Pipeline:
                    exprs:
                    - FuncCall:
                        name:
                          Indirection:
                            base:
                              Ident: math
                              span: 1:411-415
                            field: !Name log
                          span: 1:415-419
                        args:
                        - Literal:
                            Integer: 2
                          span: 1:420-421
                        - Ident: total
                          span: 1:422-427
                      span: 1:411-427
                    - FuncCall:
                        name:
                          Indirection:
                            base:
                              Ident: math
                              span: 1:430-434
                            field: !Name round
                          span: 1:434-440
                        args:
                        - Literal:
                            Integer: 3
                          span: 1:441-442
                      span: 1:430-442
                    - FuncCall:
                        name:
                          Ident: as
                          span: 1:445-447
                        args:
                        - Ident: REAL
                          span: 1:448-452
                      span: 1:445-452
                  span: 1:410-453
                  alias: total_log2
                - Pipeline:
                    exprs:
                    - FuncCall:
                        name:
                          Indirection:
                            base:
                              Ident: math
                              span: 1:473-477
                            field: !Name sqrt
                          span: 1:477-482
                        args:
                        - Ident: total
                          span: 1:483-488
                      span: 1:473-488
                    - FuncCall:
                        name:
                          Indirection:
                            base:
                              Ident: math
                              span: 1:491-495
                            field: !Name round
                          span: 1:495-501
                        args:
                        - Literal:
                            Integer: 3
                          span: 1:502-503
                      span: 1:491-503
                    - FuncCall:
                        name:
                          Ident: as
                          span: 1:506-508
                        args:
                        - Ident: REAL
                          span: 1:509-513
                      span: 1:506-513
                  span: 1:472-514
                  alias: total_sqrt
                - Pipeline:
                    exprs:
                    - FuncCall:
                        name:
                          Indirection:
                            base:
                              Ident: math
                              span: 1:532-536
                            field: !Name ln
                          span: 1:536-539
                        args:
                        - Ident: total
                          span: 1:540-545
                      span: 1:532-545
                    - Indirection:
                        base:
                          Ident: math
                          span: 1:548-552
                        field: !Name exp
                      span: 1:548-556
                    - FuncCall:
                        name:
                          Indirection:
                            base:
                              Ident: math
                              span: 1:559-563
                            field: !Name round
                          span: 1:563-569
                        args:
                        - Literal:
                            Integer: 2
                          span: 1:570-571
                      span: 1:559-571
                    - FuncCall:
                        name:
                          Ident: as
                          span: 1:574-576
                        args:
                        - Ident: REAL
                          span: 1:577-581
                      span: 1:574-581
                  span: 1:531-582
                  alias: total_ln
                - Pipeline:
                    exprs:
                    - FuncCall:
                        name:
                          Indirection:
                            base:
                              Ident: math
                              span: 1:601-605
                            field: !Name cos
                          span: 1:605-609
                        args:
                        - Ident: total
                          span: 1:610-615
                      span: 1:601-615
                    - Indirection:
                        base:
                          Ident: math
                          span: 1:618-622
                        field: !Name acos
                      span: 1:618-627
                    - FuncCall:
                        name:
                          Indirection:
                            base:
                              Ident: math
                              span: 1:630-634
                            field: !Name round
                          span: 1:634-640
                        args:
                        - Literal:
                            Integer: 2
                          span: 1:641-642
                      span: 1:630-642
                    - FuncCall:
                        name:
                          Ident: as
                          span: 1:645-647
                        args:
                        - Ident: REAL
                          span: 1:648-652
                      span: 1:645-652
                  span: 1:600-653
                  alias: total_cos
                - Pipeline:
                    exprs:
                    - FuncCall:
                        name:
                          Indirection:
                            base:
                              Ident: math
                              span: 1:672-676
                            field: !Name sin
                          span: 1:676-680
                        args:
                        - Ident: total
                          span: 1:681-686
                      span: 1:672-686
                    - Indirection:
                        base:
                          Ident: math
                          span: 1:689-693
                        field: !Name asin
                      span: 1:689-698
                    - FuncCall:
                        name:
                          Indirection:
                            base:
                              Ident: math
                              span: 1:701-705
                            field: !Name round
                          span: 1:705-711
                        args:
                        - Literal:
                            Integer: 2
                          span: 1:712-713
                      span: 1:701-713
                    - FuncCall:
                        name:
                          Ident: as
                          span: 1:716-718
                        args:
                        - Ident: REAL
                          span: 1:719-723
                      span: 1:716-723
                  span: 1:671-724
                  alias: total_sin
                - Pipeline:
                    exprs:
                    - FuncCall:
                        name:
                          Indirection:
                            base:
                              Ident: math
                              span: 1:743-747
                            field: !Name tan
                          span: 1:747-751
                        args:
                        - Ident: total
                          span: 1:752-757
                      span: 1:743-757
                    - Indirection:
                        base:
                          Ident: math
                          span: 1:760-764
                        field: !Name atan
                      span: 1:760-769
                    - FuncCall:
                        name:
                          Indirection:
                            base:
                              Ident: math
                              span: 1:772-776
                            field: !Name round
                          span: 1:776-782
                        args:
                        - Literal:
                            Integer: 2
                          span: 1:783-784
                      span: 1:772-784
                    - FuncCall:
                        name:
                          Ident: as
                          span: 1:787-789
                        args:
                        - Ident: REAL
                          span: 1:790-794
                      span: 1:787-794
                  span: 1:742-795
                  alias: total_tan
                - Pipeline:
                    exprs:
                    - Ident: total
                      span: 1:814-819
                    - Indirection:
                        base:
                          Ident: math
                          span: 1:822-826
                        field: !Name degrees
                      span: 1:822-834
                    - Indirection:
                        base:
                          Ident: math
                          span: 1:837-841
                        field: !Name radians
                      span: 1:837-849
                    - FuncCall:
                        name:
                          Indirection:
                            base:
                              Ident: math
                              span: 1:852-856
                            field: !Name round
                          span: 1:856-862
                        args:
                        - Literal:
                            Integer: 2
                          span: 1:863-864
                      span: 1:852-864
                    - FuncCall:
                        name:
                          Ident: as
                          span: 1:867-869
                        args:
                        - Ident: REAL
                          span: 1:870-874
                      span: 1:867-874
                  span: 1:813-875
                  alias: total_deg
                - Pipeline:
                    exprs:
                    - Ident: total
                      span: 1:897-902
                    - FuncCall:
                        name:
                          Indirection:
                            base:
                              Ident: math
                              span: 1:905-909
                            field: !Name pow
                          span: 1:909-913
                        args:
                        - Literal:
                            Integer: 2
                          span: 1:914-915
                      span: 1:905-915
                    - FuncCall:
                        name:
                          Indirection:
                            base:
                              Ident: math
                              span: 1:918-922
                            field: !Name round
                          span: 1:922-928
                        args:
                        - Literal:
                            Integer: 2
                          span: 1:929-930
                      span: 1:918-930
                    - FuncCall:
                        name:
                          Ident: as
                          span: 1:933-935
                        args:
                        - Ident: REAL
                          span: 1:936-940
                      span: 1:933-940
                  span: 1:896-941
                  alias: total_square
                - Pipeline:
                    exprs:
                    - Binary:
                        left:
                          Ident: total
                          span: 1:967-972
                        op: Pow
                        right:
                          Literal:
                            Integer: 2
                          span: 1:976-977
                      span: 1:966-978
                    - FuncCall:
                        name:
                          Indirection:
                            base:
                              Ident: math
                              span: 1:981-985
                            field: !Name round
                          span: 1:985-991
                        args:
                        - Literal:
                            Integer: 2
                          span: 1:992-993
                      span: 1:981-993
                    - FuncCall:
                        name:
                          Ident: as
                          span: 1:996-998
                        args:
                        - Ident: REAL
                          span: 1:999-1003
                      span: 1:996-1003
                  span: 1:965-1004
                  alias: total_square_op
                span: 1:110-1007
            span: 1:103-1007
        span: 1:82-1007
    span: 1:0-1007

---
source: prqlc/prqlc/tests/integration/queries.rs
expression: tokens
input_file: prqlc/prqlc/tests/integration/queries/distinct_on_sort_on_compute.prql
---
Tokens(
    [
        0..0: Start,
        0..4: Ident("from"),
        5..13: Ident("invoices"),
        13..14: NewLine,
        14..20: Ident("derive"),
        21..25: Ident("code"),
        26..27: Control('='),
        28..32: Keyword("case"),
        33..34: Control('['),
        34..45: Ident("customer_id"),
        46..47: Control('<'),
        48..50: Literal(Integer(10)),
        51..53: ArrowFat,
        54..73: Ident("billing_postal_code"),
        73..74: Control(','),
        75..79: Literal(Boolean(true)),
        80..82: ArrowFat,
        83..87: Literal(Null),
        87..88: Control(']'),
        88..89: NewLine,
        89..94: Ident("group"),
        95..96: Control('{'),
        96..107: Ident("customer_id"),
        107..108: Control(','),
        109..121: Ident("billing_city"),
        121..122: Control(','),
        123..138: Ident("billing_country"),
        138..139: Control('}'),
        140..141: Control('('),
        141..142: NewLine,
        144..148: Ident("sort"),
        149..150: Control('{'),
        150..151: Control('-'),
        151..155: Ident("this"),
        155..156: Control('.'),
        156..160: Ident("code"),
        160..161: Control('}'),
        161..162: NewLine,
        164..168: Ident("take"),
        169..170: Literal(Integer(1)),
        170..171: NewLine,
        171..172: Control(')'),
        172..173: NewLine,
        173..179: Ident("filter"),
        180..181: Control('('),
        181..192: Ident("customer_id"),
        193..194: Control('|'),
        195..197: Ident("in"),
        198..199: Control('['),
        199..200: Literal(Integer(4)),
        200..201: Control(']'),
        201..202: Control(')'),
        202..203: NewLine,
        203..208: Ident("group"),
        209..210: Control('{'),
        210..225: Ident("billing_country"),
        225..226: Control('}'),
        227..228: Control('('),
        228..237: Ident("aggregate"),
        238..239: Control('{'),
        239..244: Ident("total"),
        245..246: Control('='),
        247..251: Ident("math"),
        251..252: Control('.'),
        252..257: Ident("round"),
        258..259: Literal(Integer(2)),
        260..261: Control('('),
        261..264: Ident("sum"),
        265..270: Ident("total"),
        270..271: Control(')'),
        271..272: Control('}'),
        272..273: Control(')'),
        273..274: NewLine,
    ],
)

---
source: prqlc/prqlc/tests/integration/queries.rs
expression: "# mssql:test\nlet distinct = rel -> (from t = _param.rel | group {t.*} (take 1))\n\nfrom_text format:json '{ \"columns\": [\"a\"], \"data\": [[1], [2], [2], [3]] }'\ndistinct\nremove (from_text format:json '{ \"columns\": [\"a\"], \"data\": [[1], [2]] }')\nsort a\n"
input_file: prqlc/prqlc/tests/integration/queries/set_ops_remove.prql
---
{"frames":[["0:3606-3683",{"columns":[{"Single":{"name":["t","a"],"target_id":136,"target_name":null}},{"Single":{"name":["b","a"],"target_id":122,"target_name":"a"}}],"inputs":[{"id":127,"name":"t","table":["default_db","_literal_127"]},{"id":122,"name":"b","table":["default_db","_literal_122"]}]}],["0:3686-3731",{"columns":[{"Single":{"name":["t","a"],"target_id":136,"target_name":null}},{"Single":{"name":["b","a"],"target_id":122,"target_name":"a"}}],"inputs":[{"id":127,"name":"t","table":["default_db","_literal_127"]},{"id":122,"name":"b","table":["default_db","_literal_122"]}]}],["1:165-238",{"columns":[{"Single":{"name":["t","a"],"target_id":207,"target_name":null}}],"inputs":[{"id":127,"name":"t","table":["default_db","_literal_127"]},{"id":122,"name":"b","table":["default_db","_literal_122"]}]}],["1:239-245",{"columns":[{"Single":{"name":["t","a"],"target_id":207,"target_name":null}}],"inputs":[{"id":127,"name":"t","table":["default_db","_literal_127"]},{"id":122,"name":"b","table":["default_db","_literal_122"]}]}]],"nodes":[{"id":122,"kind":"Array","span":"1:173-237","parent":189},{"id":127,"kind":"Array","span":"1:36-55","parent":154},{"id":136,"kind":"Ident","ident":{"Ident":["this","t","a"]},"targets":[127],"parent":138},{"id":138,"kind":"Tuple","span":"1:64-69","children":[136]},{"id":154,"kind":"TransformCall: Take","children":[127,155],"parent":189},{"id":155,"kind":"Literal","parent":154},{"id":178,"kind":"Ident","ident":{"Ident":["this","t","a"]},"targets":[136]},{"id":181,"kind":"Ident","ident":{"Ident":["that","b","a"]},"targets":[122]},{"id":187,"kind":"RqOperator","span":"0:3635-3682","targets":[178,181],"parent":189},{"id":189,"kind":"TransformCall: Join","span":"0:3606-3683","children":[154,122,187],"parent":205},{"id":197,"kind":"Ident","span":"0:6789-6791","ident":{"Ident":["this","b","a"]},"targets":[122]},{"id":201,"kind":"RqOperator","span":"0:3694-3730","targets":[197,204],"parent":205},{"id":204,"kind":"Literal","span":"0:6795-6799"},{"id":205,"kind":"TransformCall: Filter","span":"0:3686-3731","children":[189,201],"parent":209},{"id":207,"kind":"Ident","ident":{"Ident":["this","t","a"]},"targets":[136],"parent":208},{"id":208,"kind":"Tuple","span":"0:3742-3744","children":[207],"parent":209},{"id":209,"kind":"TransformCall: Select","span":"1:165-238","children":[205,208],"parent":212},{"id":210,"kind":"Ident","span":"1:244-245","ident":{"Ident":["this","t","a"]},"targets":[207],"parent":212},{"id":212,"kind":"TransformCall: Sort","span":"1:239-245","children":[209,210]}],"ast":{"name":"Project","stmts":[{"VarDef":{"kind":"Let","name":"distinct","value":{"Func":{"return_ty":null,"body":{"Pipeline":{"exprs":[{"FuncCall":{"name":{"Ident":"from"},"args":[{"Indirection":{"base":{"Ident":"_param"},"field":{"Name":"rel"}},"alias":"t"}]}},{"FuncCall":{"name":{"Ident":"group"},"args":[{"Tuple":[{"Indirection":{"base":{"Ident":"t"},"field":"Star"}}]},{"FuncCall":{"name":{"Ident":"take"},"args":[{"Literal":{"Integer":1}}]}}]}}]}},"params":[{"name":"rel","default_value":null}],"named_params":[],"generic_type_params":[]}}},"span":"1:13-79"},{"VarDef":{"kind":"Main","name":"main","value":{"Pipeline":{"exprs":[{"FuncCall":{"name":{"Ident":"from_text"},"args":[{"Literal":{"String":"{ \"columns\": [\"a\"], \"data\": [[1], [2], [2], [3]] }"}}],"named_args":{"format":{"Ident":"json"}}}},{"Ident":"distinct"},{"FuncCall":{"name":{"Ident":"remove"},"args":[{"FuncCall":{"name":{"Ident":"from_text"},"args":[{"Literal":{"String":"{ \"columns\": [\"a\"], \"data\": [[1], [2]] }"}}],"named_args":{"format":{"Ident":"json"}}}}]}},{"FuncCall":{"name":{"Ident":"sort"},"args":[{"Ident":"a"}]}}]}}},"span":"1:81-246"}]}}

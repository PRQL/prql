prql target:sql.postgres

let invoices_wrap = (
  from invoices
  select { invoice_id, billing_country }
)

let employees_wrap = (
  from employees
  select { employee_id, country }
)

let invoices_final = (
  from invoices_wrap
  select { invoice_id, billing_country }
  derive { source = f"{billing_country} from invoices" }
)

let employees_final = (
  from employees_wrap
  select { employee_id, country }
  derive { source = f"{country} from employees" }
)

from invoices_final
append employees_final

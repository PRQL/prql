---
source: prqlc/prqlc/src/semantic/resolver/transforms.rs
expression: expr
---
TransformCall:
  input:
    Ident:
      - default_db
      - c_invoice
    span: "1:9-23"
    ty:
      kind:
        Array:
          kind:
            Tuple:
              - Wildcard:
                  kind: Any
                  span: "0:2141-2148"
                  name: ~
          span: "0:2138-2149"
          name: tuple
      span: "0:2254-2261"
      name: relation
    lineage:
      columns:
        - All:
            input_id: 120
            except: []
      inputs:
        - id: 120
          name: c_invoice
          table:
            - default_db
            - c_invoice
  kind:
    Aggregate:
      assigns:
        Tuple:
          - RqOperator:
              name: std.average
              args:
                - Ident:
                    - this
                    - c_invoice
                    - amount
                  span: "1:81-87"
                  ty:
                    kind:
                      Array:
                        kind: Any
                        span: "0:2025-2032"
                        name: ~
                    span: "0:2024-2033"
                    name: array
            span: "1:73-87"
            ty:
              kind:
                Union:
                  - - ~
                    - kind:
                        Primitive: Float
                      span: "0:4284-4289"
                      name: ~
                  - - ~
                    - kind:
                        Singleton: "Null"
                      span: "0:4293-4297"
                      name: ~
              span: "0:4284-4297"
              name: ~
        span: "1:73-87"
        ty:
          kind:
            Tuple:
              - Single:
                  - ~
                  - kind:
                      Union:
                        - - ~
                          - kind:
                              Primitive: Float
                            span: "0:4284-4289"
                            name: ~
                        - - ~
                          - kind:
                              Singleton: "Null"
                            span: "0:4293-4297"
                            name: ~
                    span: "0:4284-4297"
                    name: ~
          span: ~
          name: ~
  partition:
    Tuple:
      - Ident:
          - this
          - c_invoice
          - issued_at
        span: "1:38-47"
        ty:
          kind:
            Union:
              - - ~
                - kind:
                    Union:
                      - - ~
                        - kind:
                            Primitive: Int
                          span: "0:2059-2062"
                          name: ~
                      - - ~
                        - kind:
                            Primitive: Float
                          span: "0:2066-2071"
                          name: ~
                      - - ~
                        - kind:
                            Primitive: Bool
                          span: "0:2075-2079"
                          name: ~
                      - - ~
                        - kind:
                            Primitive: Text
                          span: "0:2083-2087"
                          name: ~
                      - - ~
                        - kind:
                            Primitive: Date
                          span: "0:2091-2095"
                          name: ~
                      - - ~
                        - kind:
                            Primitive: Time
                          span: "0:2099-2103"
                          name: ~
                      - - ~
                        - kind:
                            Primitive: Timestamp
                          span: "0:2107-2116"
                          name: ~
                      - - ~
                        - kind:
                            Singleton: "Null"
                          span: "0:2120-2124"
                          name: ~
                  span: "0:2059-2124"
                  name: scalar
              - - ~
                - kind:
                    Tuple:
                      - Wildcard:
                          kind: Any
                          span: "0:2141-2148"
                          name: ~
                  span: "0:2138-2149"
                  name: tuple
          span: "0:3109-3124"
          name: ~
    span: "1:38-47"
    ty:
      kind:
        Tuple:
          - Single:
              - issued_at
              - kind:
                  Union:
                    - - ~
                      - kind:
                          Union:
                            - - ~
                              - kind:
                                  Primitive: Int
                                span: "0:2059-2062"
                                name: ~
                            - - ~
                              - kind:
                                  Primitive: Float
                                span: "0:2066-2071"
                                name: ~
                            - - ~
                              - kind:
                                  Primitive: Bool
                                span: "0:2075-2079"
                                name: ~
                            - - ~
                              - kind:
                                  Primitive: Text
                                span: "0:2083-2087"
                                name: ~
                            - - ~
                              - kind:
                                  Primitive: Date
                                span: "0:2091-2095"
                                name: ~
                            - - ~
                              - kind:
                                  Primitive: Time
                                span: "0:2099-2103"
                                name: ~
                            - - ~
                              - kind:
                                  Primitive: Timestamp
                                span: "0:2107-2116"
                                name: ~
                            - - ~
                              - kind:
                                  Singleton: "Null"
                                span: "0:2120-2124"
                                name: ~
                        span: "0:2059-2124"
                        name: scalar
                    - - ~
                      - kind:
                          Tuple:
                            - Wildcard:
                                kind: Any
                                span: "0:2141-2148"
                                name: ~
                        span: "0:2138-2149"
                        name: tuple
                span: "0:3109-3124"
                name: ~
      span: ~
      name: ~
span: "1:62-88"
ty:
  kind:
    Array:
      kind:
        Tuple:
          - Single:
              - issued_at
              - kind:
                  Union:
                    - - ~
                      - kind:
                          Union:
                            - - ~
                              - kind:
                                  Primitive: Int
                                span: "0:2059-2062"
                                name: ~
                            - - ~
                              - kind:
                                  Primitive: Float
                                span: "0:2066-2071"
                                name: ~
                            - - ~
                              - kind:
                                  Primitive: Bool
                                span: "0:2075-2079"
                                name: ~
                            - - ~
                              - kind:
                                  Primitive: Text
                                span: "0:2083-2087"
                                name: ~
                            - - ~
                              - kind:
                                  Primitive: Date
                                span: "0:2091-2095"
                                name: ~
                            - - ~
                              - kind:
                                  Primitive: Time
                                span: "0:2099-2103"
                                name: ~
                            - - ~
                              - kind:
                                  Primitive: Timestamp
                                span: "0:2107-2116"
                                name: ~
                            - - ~
                              - kind:
                                  Singleton: "Null"
                                span: "0:2120-2124"
                                name: ~
                        span: "0:2059-2124"
                        name: scalar
                    - - ~
                      - kind:
                          Tuple:
                            - Wildcard:
                                kind: Any
                                span: "0:2141-2148"
                                name: ~
                        span: "0:2138-2149"
                        name: tuple
                span: "0:3109-3124"
                name: ~
          - Single:
              - ~
              - kind:
                  Union:
                    - - ~
                      - kind:
                          Primitive: Float
                        span: "0:4284-4289"
                        name: ~
                    - - ~
                      - kind:
                          Singleton: "Null"
                        span: "0:4293-4297"
                        name: ~
                span: "0:4284-4297"
                name: ~
      span: ~
      name: ~
  span: ~
  name: ~
lineage:
  columns:
    - Single:
        name:
          - c_invoice
          - issued_at
        target_id: 122
        target_name: ~
    - Single:
        name: ~
        target_id: 138
        target_name: ~
  inputs:
    - id: 120
      name: c_invoice
      table:
        - default_db
        - c_invoice

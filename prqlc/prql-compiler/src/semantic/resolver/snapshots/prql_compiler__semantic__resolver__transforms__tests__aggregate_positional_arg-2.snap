---
source: prqlc/prql-compiler/src/semantic/resolver/transforms.rs
expression: expr
---
TransformCall:
  input:
    Ident:
      - default_db
      - c_invoice
    ty:
      kind:
        Array:
          kind:
            Tuple:
              - Wildcard: ~
          span: ~
          name: ~
      span: ~
      name: ~
    lineage:
      columns:
        - All:
            input_id: 76
            except: []
      inputs:
        - id: 76
          name: c_invoice
          table:
            - default_db
            - c_invoice
  kind:
    Aggregate:
      assigns:
        - RqOperator:
            name: std.average
            args:
              - Ident:
                  - this
                  - c_invoice
                  - amount
                ty:
                  kind:
                    Array:
                      kind: Any
                      span: "2:1878-1885"
                      name: ~
                  span: "2:1877-1886"
                  name: array
          ty:
            kind:
              Union:
                - - ~
                  - kind:
                      Primitive: Float
                    span: "2:4174-4179"
                    name: ~
                - - ~
                  - kind:
                      Singleton: "Null"
                    span: "2:4183-4187"
                    name: ~
            span: "2:4174-4187"
            name: ~
  partition:
    - Ident:
        - this
        - c_invoice
        - issued_at
      ty:
        kind:
          Union:
            - - ~
              - kind:
                  Union:
                    - - ~
                      - kind:
                          Primitive: Int
                        span: "2:1912-1915"
                        name: ~
                    - - ~
                      - kind:
                          Primitive: Float
                        span: "2:1919-1924"
                        name: ~
                    - - ~
                      - kind:
                          Primitive: Bool
                        span: "2:1928-1932"
                        name: ~
                    - - ~
                      - kind:
                          Primitive: Text
                        span: "2:1936-1940"
                        name: ~
                    - - ~
                      - kind:
                          Primitive: Date
                        span: "2:1944-1948"
                        name: ~
                    - - ~
                      - kind:
                          Primitive: Time
                        span: "2:1952-1956"
                        name: ~
                    - - ~
                      - kind:
                          Primitive: Timestamp
                        span: "2:1960-1969"
                        name: ~
                    - - ~
                      - kind:
                          Singleton: "Null"
                        span: "2:1973-1977"
                        name: ~
                span: "2:1912-1977"
                name: scalar
            - - ~
              - kind:
                  Tuple:
                    - Wildcard:
                        kind: Any
                        span: "2:1992-1999"
                        name: ~
                span: "2:1991-2002"
                name: tuple
        span: "2:3001-3016"
        name: ~
ty:
  kind:
    Array:
      kind:
        Tuple:
          - Wildcard:
              kind: Any
              span: "2:1992-1999"
              name: ~
      span: "2:1991-2002"
      name: tuple
  span: "2:2107-2114"
  name: relation
lineage:
  columns:
    - Single:
        name:
          - c_invoice
          - issued_at
        target_id: 77
        target_name: ~
    - Single:
        name: ~
        target_id: 84
        target_name: ~
  inputs:
    - id: 76
      name: c_invoice
      table:
        - default_db
        - c_invoice


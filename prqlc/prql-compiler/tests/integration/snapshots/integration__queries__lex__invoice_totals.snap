---
source: prqlc/prql-compiler/tests/integration/queries.rs
expression: tokens
input_file: prqlc/prql-compiler/tests/integration/queries/invoice_totals.prql
---
TokenStream (
  56..57: NewLine,
  57..61: Ident("from"),
  62..63: Ident("i"),
  63..64: Control('='),
  64..72: Ident("invoices"),
  72..73: NewLine,
  73..77: Ident("join"),
  78..80: Ident("ii"),
  80..81: Control('='),
  81..94: Ident("invoice_items"),
  95..96: Control('('),
  96..98: Eq,
  98..108: Ident("invoice_id"),
  108..109: Control(')'),
  109..110: NewLine,
  110..116: Ident("derive"),
  117..118: Control('{'),
  118..119: NewLine,
  123..127: Ident("city"),
  128..129: Control('='),
  130..131: Ident("i"),
  131..132: Control('.'),
  132..144: Ident("billing_city"),
  144..145: Control(','),
  145..146: NewLine,
  150..156: Ident("street"),
  157..158: Control('='),
  159..160: Ident("i"),
  160..161: Control('.'),
  161..176: Ident("billing_address"),
  176..177: Control(','),
  177..178: NewLine,
  178..179: Control('}'),
  179..180: NewLine,
  180..185: Ident("group"),
  186..187: Control('{'),
  187..191: Ident("city"),
  191..192: Control(','),
  193..199: Ident("street"),
  199..200: Control('}'),
  201..202: Control('('),
  202..203: NewLine,
  207..213: Ident("derive"),
  214..219: Ident("total"),
  220..221: Control('='),
  222..224: Ident("ii"),
  224..225: Control('.'),
  225..235: Ident("unit_price"),
  236..237: Control('*'),
  238..240: Ident("ii"),
  240..241: Control('.'),
  241..249: Ident("quantity"),
  249..250: NewLine,
  254..263: Ident("aggregate"),
  264..265: Control('{'),
  265..266: NewLine,
  274..284: Ident("num_orders"),
  285..286: Control('='),
  287..301: Ident("count_distinct"),
  302..303: Ident("i"),
  303..304: Control('.'),
  304..314: Ident("invoice_id"),
  314..315: Control(','),
  315..316: NewLine,
  324..334: Ident("num_tracks"),
  335..336: Control('='),
  337..340: Ident("sum"),
  341..343: Ident("ii"),
  343..344: Control('.'),
  344..352: Ident("quantity"),
  352..353: Control(','),
  353..354: NewLine,
  362..373: Ident("total_price"),
  374..375: Control('='),
  376..379: Ident("sum"),
  380..385: Ident("total"),
  385..386: Control(','),
  386..387: NewLine,
  391..392: Control('}'),
  392..393: NewLine,
  393..394: Control(')'),
  394..395: NewLine,
  395..400: Ident("group"),
  401..402: Control('{'),
  402..406: Ident("city"),
  406..407: Control('}'),
  408..409: Control('('),
  409..410: NewLine,
  414..418: Ident("sort"),
  419..425: Ident("street"),
  425..426: NewLine,
  430..436: Ident("window"),
  437..446: Ident("expanding"),
  446..447: Control(':'),
  447..451: Literal(Boolean(true)),
  452..453: Control('('),
  453..454: NewLine,
  462..468: Ident("derive"),
  469..470: Control('{'),
  470..494: Ident("running_total_num_tracks"),
  495..496: Control('='),
  497..500: Ident("sum"),
  501..511: Ident("num_tracks"),
  511..512: Control('}'),
  512..513: NewLine,
  517..518: Control(')'),
  518..519: NewLine,
  519..520: Control(')'),
  520..521: NewLine,
  521..525: Ident("sort"),
  526..527: Control('{'),
  527..531: Ident("city"),
  531..532: Control(','),
  533..539: Ident("street"),
  539..540: Control('}'),
  540..541: NewLine,
  541..547: Ident("derive"),
  548..549: Control('{'),
  549..569: Ident("num_tracks_last_week"),
  570..571: Control('='),
  572..575: Ident("lag"),
  576..577: Literal(Integer(7)),
  578..588: Ident("num_tracks"),
  588..589: Control('}'),
  589..590: NewLine,
  590..596: Ident("select"),
  597..598: Control('{'),
  598..599: NewLine,
  603..607: Ident("city"),
  607..608: Control(','),
  608..609: NewLine,
  613..619: Ident("street"),
  619..620: Control(','),
  620..621: NewLine,
  625..635: Ident("num_orders"),
  635..636: Control(','),
  636..637: NewLine,
  641..651: Ident("num_tracks"),
  651..652: Control(','),
  652..653: NewLine,
  657..681: Ident("running_total_num_tracks"),
  681..682: Control(','),
  682..683: NewLine,
  687..707: Ident("num_tracks_last_week"),
  707..708: NewLine,
  708..709: Control('}'),
  709..710: NewLine,
  710..714: Ident("take"),
  715..717: Literal(Integer(20)),
  717..718: NewLine,
)

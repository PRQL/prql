label: Joins
prql: |
  from.employees
  join (from.benefits | select {b = this}) (==employee_id)
  join side:left from.positions (positions.id==employees.employee_id)
  select {employees.employee_id, positions.role, b.vision_coverage}
sql: |
  WITH table_0 AS (
    SELECT * FROM benefits
  )
  SELECT
    employees.employee_id,
    positions.role,
    table_0.vision_coverage
  FROM
    employees
    JOIN table_0 ON employees.employee_id = table_0.employee_id
    LEFT JOIN positions ON positions.id = employees.employee_id

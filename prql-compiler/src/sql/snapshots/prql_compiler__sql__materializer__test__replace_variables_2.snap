---
source: prql-compiler/src/sql/materializer.rs
expression: "&mat"
---
- From:
    name: employees
    alias: ~
    declared_at: 29
    ty:
      Table:
        columns:
          - All: 29
        sort: []
        tables: []
- Filter:
    Binary:
      left:
        Ident: country
      op: Eq
      right:
        Literal:
          String: USA
        ty:
          Literal: String
    ty:
      Literal: Bool
- Filter:
    Binary:
      left:
        Binary:
          left:
            Binary:
              left:
                Ident: salary
              op: Add
              right:
                Ident: payroll_tax
            ty:
              Literal: Column
          op: Add
          right:
            Ident: benefits_cost
        ty:
          Literal: Column
      op: Gt
      right:
        Literal:
          Integer: 0
        ty:
          Literal: Integer
    ty:
      Literal: Bool
- Group:
    by:
      - Ident: title
      - Ident: country
    pipeline:
      - kind:
          Aggregate:
            assigns:
              - SString:
                  - String: AVG(
                  - Expr:
                      Ident: salary
                  - String: )
                ty:
                  Literal: Column
              - SString:
                  - String: SUM(
                  - Expr:
                      Ident: salary
                  - String: )
                ty:
                  Literal: Column
              - SString:
                  - String: AVG(
                  - Expr:
                      Binary:
                        left:
                          Ident: salary
                        op: Add
                        right:
                          Ident: payroll_tax
                      ty:
                        Literal: Column
                  - String: )
                ty:
                  Literal: Column
              - SString:
                  - String: SUM(
                  - Expr:
                      Binary:
                        left:
                          Ident: salary
                        op: Add
                        right:
                          Ident: payroll_tax
                      ty:
                        Literal: Column
                  - String: )
                ty:
                  Literal: Column
              - SString:
                  - String: AVG(
                  - Expr:
                      Binary:
                        left:
                          Binary:
                            left:
                              Ident: salary
                            op: Add
                            right:
                              Ident: payroll_tax
                          ty:
                            Literal: Column
                        op: Add
                        right:
                          Ident: benefits_cost
                      ty:
                        Literal: Column
                  - String: )
                ty:
                  Literal: Column
              - SString:
                  - String: SUM(
                  - Expr:
                      Binary:
                        left:
                          Binary:
                            left:
                              Ident: salary
                            op: Add
                            right:
                              Ident: payroll_tax
                          ty:
                            Literal: Column
                        op: Add
                        right:
                          Ident: benefits_cost
                      ty:
                        Literal: Column
                  - String: )
                ty:
                  Literal: Column
                alias: sum_gross_cost
              - SString:
                  - String: COUNT(
                  - Expr:
                      SString:
                        - String: "*"
                      ty: Infer
                  - String: )
                ty:
                  Literal: Column
                alias: ct
            by: []
        is_complex: false
        ty:
          columns:
            - Unnamed: 42
            - Unnamed: 43
            - Unnamed: 44
            - Unnamed: 45
            - Unnamed: 46
            - Named:
                - sum_gross_cost
                - 40
            - Named:
                - ct
                - 41
          sort: []
          tables: []
        span: ~
- Filter:
    Binary:
      left:
        SString:
          - String: SUM(
          - Expr:
              Binary:
                left:
                  Binary:
                    left:
                      Ident: salary
                    op: Add
                    right:
                      Ident: payroll_tax
                  ty:
                    Literal: Column
                op: Add
                right:
                  Ident: benefits_cost
              ty:
                Literal: Column
          - String: )
        ty:
          Literal: Column
      op: Gt
      right:
        Literal:
          Integer: 200
        ty:
          Literal: Integer
    ty:
      Literal: Bool
- Take:
    range:
      start: ~
      end:
        Literal:
          Integer: 20
    by: []
    sort: []


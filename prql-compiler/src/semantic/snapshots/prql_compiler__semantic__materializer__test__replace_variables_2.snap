---
source: prql-compiler/src/semantic/materializer.rs
expression: "&mat"
---
- Pipeline:
    - From:
        name: employees
        alias: ~
    - Filter:
        - Expr:
            - Ident: country
            - Raw: "="
            - String: USA
    - Derive:
        - NamedExpr:
            name: gross_salary
            expr:
              Expr:
                - Ident: salary
                - Raw: +
                - Ident: payroll_tax
        - NamedExpr:
            name: gross_cost
            expr:
              Expr:
                - Expr:
                    - Ident: salary
                    - Raw: +
                    - Ident: payroll_tax
                - Raw: +
                - Ident: benefits_cost
    - Filter:
        - Expr:
            - Expr:
                - Expr:
                    - Ident: salary
                    - Raw: +
                    - Ident: payroll_tax
                - Raw: +
                - Ident: benefits_cost
            - Raw: ">"
            - Raw: "0"
    - Aggregate:
        by:
          - Ident: title
          - Ident: country
        select: []
    - Sort:
        - direction: Asc
          column:
            SString:
              - String: SUM(
              - Expr:
                  Expr:
                    - Expr:
                        - Ident: salary
                        - Raw: +
                        - Ident: payroll_tax
                    - Raw: +
                    - Ident: benefits_cost
              - String: )
    - Filter:
        - Expr:
            - SString:
                - String: SUM(
                - Expr:
                    Expr:
                      - Expr:
                          - Ident: salary
                          - Raw: +
                          - Ident: payroll_tax
                      - Raw: +
                      - Ident: benefits_cost
                - String: )
            - Raw: ">"
            - Raw: "200"
    - Take: 20

